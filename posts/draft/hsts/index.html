<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HSTS and Preloading | Jdsec</title>
<meta name=keywords content="Web,Network"><meta name=description content="HSTS directs the browser to use HTTPS for certain domains (optionally subdomains). This mitigates some MitM attacks by upgrading HTTP connections to HTTPS.
HSTS Preloading
The native implementation of HSTS communicates the HSTS policy to the browser via an HTTP response header Strict-Transport-Security: max-age=31536000; includeSubDomains. HSTS requires a user to visit a website once before HSTS protection is cached.
But what if HTTP is used on the first visit or a user clears their cache frequently? An attacker can still redirect the user to a malicious site by altering the response."><meta name=author content="JD"><link rel=canonical href=https://technologify.net/posts/draft/hsts/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://technologify.net/posts/draft/hsts/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://technologify.net/posts/draft/hsts/"><meta property="og:site_name" content="Jdsec"><meta property="og:title" content="HSTS and Preloading"><meta property="og:description" content="HSTS directs the browser to use HTTPS for certain domains (optionally subdomains). This mitigates some MitM attacks by upgrading HTTP connections to HTTPS.
HSTS Preloading The native implementation of HSTS communicates the HSTS policy to the browser via an HTTP response header Strict-Transport-Security: max-age=31536000; includeSubDomains. HSTS requires a user to visit a website once before HSTS protection is cached.
But what if HTTP is used on the first visit or a user clears their cache frequently? An attacker can still redirect the user to a malicious site by altering the response."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-24T21:36:19+10:00"><meta property="article:modified_time" content="2022-06-24T21:36:19+10:00"><meta property="article:tag" content="Web"><meta property="article:tag" content="Network"><meta property="og:image" content="https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HSTS and Preloading"><meta name=twitter:description content="HSTS directs the browser to use HTTPS for certain domains (optionally subdomains). This mitigates some MitM attacks by upgrading HTTP connections to HTTPS.
HSTS Preloading
The native implementation of HSTS communicates the HSTS policy to the browser via an HTTP response header Strict-Transport-Security: max-age=31536000; includeSubDomains. HSTS requires a user to visit a website once before HSTS protection is cached.
But what if HTTP is used on the first visit or a user clears their cache frequently? An attacker can still redirect the user to a malicious site by altering the response."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://technologify.net/posts/"},{"@type":"ListItem","position":2,"name":"HSTS and Preloading","item":"https://technologify.net/posts/draft/hsts/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HSTS and Preloading","name":"HSTS and Preloading","description":"HSTS directs the browser to use HTTPS for certain domains (optionally subdomains). This mitigates some MitM attacks by upgrading HTTP connections to HTTPS.\nHSTS Preloading The native implementation of HSTS communicates the HSTS policy to the browser via an HTTP response header Strict-Transport-Security: max-age=31536000; includeSubDomains. HSTS requires a user to visit a website once before HSTS protection is cached.\nBut what if HTTP is used on the first visit or a user clears their cache frequently? An attacker can still redirect the user to a malicious site by altering the response.\n","keywords":["Web","Network"],"articleBody":"HSTS directs the browser to use HTTPS for certain domains (optionally subdomains). This mitigates some MitM attacks by upgrading HTTP connections to HTTPS.\nHSTS Preloading The native implementation of HSTS communicates the HSTS policy to the browser via an HTTP response header Strict-Transport-Security: max-age=31536000; includeSubDomains. HSTS requires a user to visit a website once before HSTS protection is cached.\nBut what if HTTP is used on the first visit or a user clears their cache frequently? An attacker can still redirect the user to a malicious site by altering the response.\nEnter HSTS Preloading. It ensures common domains are configured with HSTS without requiring an initial vulnerable visit.\nAnother method to upgrade HTTP requests is to enforce HTTPS only connections in your browser.\nHSTS Preloading Implementation - DevTools Let’s see how HSTS Preloading works in practice.\nVisiting http://www.google.com/ The browser appears to send a request to an internal service to upgrade the HTTP request. No HTTP requests hit the network interface. Confirming this is internal to the browser. Visiting http://google.com/ http://google.com/ redirects to http://www.google.com The request and redirect response hit the network interface in the Wireshark capture below.\nSimilar to above, http://www.google.com/ is upgraded to https://www.google.com/ internally within the browser.\nIf you need to visit Google manually, you should probably type www.google.com rather than google.com. Address bar searches use HTTPS by default.\nConclusion HSTS is a powerful mechanism for protecting users against MitM attacks such as SSL Stripping or Session Hijacking.\nBut HSTS isn’t a simple on/off switch on the client side. Many vulnerable combinations of settings exist, depending on the server and user input.\nAdditional Reading Not So Strict Transport Security ","wordCount":"272","inLanguage":"en","image":"https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2022-06-24T21:36:19+10:00","dateModified":"2022-06-24T21:36:19+10:00","author":{"@type":"Person","name":"JD"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://technologify.net/posts/draft/hsts/"},"publisher":{"@type":"Organization","name":"Jdsec","logo":{"@type":"ImageObject","url":"https://technologify.net/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://technologify.net/ accesskey=h title="Home (Alt + H)"><img src=https://technologify.net/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://technologify.net/categories/ title=categories><span>categories</span></a></li><li><a href=https://technologify.net/tags/ title=tags><span>tags</span></a></li><li><a href=https://technologify.net/archives/ title=archives><span>archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://technologify.net/>Home</a>&nbsp;»&nbsp;<a href=https://technologify.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HSTS and Preloading</h1><div class=post-meta><span title='2022-06-24 21:36:19 +1000 +1000'>24 June, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;272 words&nbsp;·&nbsp;JD</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#hsts-preloading aria-label="HSTS Preloading">HSTS Preloading</a></li><li><a href=#hsts-preloading-implementation---devtools aria-label="HSTS Preloading Implementation - DevTools">HSTS Preloading Implementation - DevTools</a></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li><li><a href=#additional-reading aria-label="Additional Reading">Additional Reading</a></li></ul></div></details></div><div class=post-content><p><a href=https://www.chromium.org/hsts/>HSTS</a> directs the browser to use HTTPS for certain domains (optionally subdomains). This mitigates some MitM attacks by upgrading HTTP connections to HTTPS.</p><h2 id=hsts-preloading>HSTS Preloading<a hidden class=anchor aria-hidden=true href=#hsts-preloading>#</a></h2><p>The native implementation of HSTS communicates the HSTS policy to the browser via an HTTP response header <code>Strict-Transport-Security: max-age=31536000; includeSubDomains</code>. HSTS requires a user to visit a website once before HSTS protection is cached.</p><p>But what if HTTP is used on the first visit or a user clears their cache frequently? An attacker can still redirect the user to a malicious site by altering the response.</p><p>Enter <a href=https://hstspreload.org/>HSTS Preloading</a>. It ensures common domains are configured with HSTS without requiring an initial vulnerable visit.</p><blockquote><p>Another method to upgrade HTTP requests is to <a href=https://beebom.com/how-enable-https-only-mode-chrome-firefox-edge-safari/>enforce HTTPS only connections in your browser</a>.</p></blockquote><h2 id=hsts-preloading-implementation---devtools>HSTS Preloading Implementation - DevTools<a hidden class=anchor aria-hidden=true href=#hsts-preloading-implementation---devtools>#</a></h2><p>Let&rsquo;s see how HSTS Preloading works in practice.</p><ol><li>Visiting <code>http://www.google.com/</code></li></ol><p>The browser appears to send a request to an internal service to upgrade the HTTP request.
<img alt=Chrome loading=lazy src=/chrome_WTwn1F0gEw.png></p><p>No HTTP requests hit the network interface. Confirming this is internal to the browser.
<img alt=Wireshark loading=lazy src=/Wireshark_JgWebww8WD.png></p><ol start=2><li>Visiting <code>http://google.com/</code></li></ol><p><code>http://google.com/</code> redirects to <code>http://www.google.com</code> The request and redirect response hit the network interface in the Wireshark capture below.</p><p>Similar to above, <code>http://www.google.com/</code> is upgraded to <code>https://www.google.com/</code> internally within the browser.</p><p><img alt=HSTS loading=lazy src=/hsts-http.png></p><p><img alt=Wireshark loading=lazy src=/Wireshark_OFBvtEFMto.png></p><blockquote><p>If you need to visit Google manually, you should probably type <code>www.google.com</code> rather than <code>google.com</code>. Address bar searches use HTTPS by default.</p></blockquote><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>HSTS is a powerful mechanism for protecting users against MitM attacks such as SSL Stripping or Session Hijacking.</p><p>But HSTS isn&rsquo;t a simple on/off switch on the client side. Many vulnerable combinations of settings exist, depending on the server and user input.</p><h2 id=additional-reading>Additional Reading<a hidden class=anchor aria-hidden=true href=#additional-reading>#</a></h2><ul><li><a href=https://research.aurainfosec.io/not-so-strict-transport-security/>Not So Strict Transport Security</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://technologify.net/tags/web/>Web</a></li><li><a href=https://technologify.net/tags/network/>Network</a></li></ul><nav class=paginav><a class=next href=https://technologify.net/posts/security/elastiflow/><span class=title>Next »</span><br><span>Elastiflow</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://technologify.net/>Jdsec</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>