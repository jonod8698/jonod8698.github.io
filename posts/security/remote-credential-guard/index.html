<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Remote Credential Guard | Jdsec</title>
<meta name=keywords content="Remote Credential Guard,Kerberos"><meta name=description content="Remote Credential Guard"><meta name=author content="JD"><link rel=canonical href=https://technologify.net/posts/security/remote-credential-guard/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://technologify.net/posts/security/remote-credential-guard/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://technologify.net/posts/security/remote-credential-guard/"><meta property="og:site_name" content="Jdsec"><meta property="og:title" content="Remote Credential Guard"><meta property="og:description" content="Remote Credential Guard"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-19T00:27:04+11:00"><meta property="article:modified_time" content="2022-03-19T00:27:04+11:00"><meta property="article:tag" content="Remote Credential Guard"><meta property="article:tag" content="Kerberos"><meta property="og:image" content="https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Remote Credential Guard"><meta name=twitter:description content="Remote Credential Guard"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://technologify.net/posts/"},{"@type":"ListItem","position":2,"name":"Remote Credential Guard","item":"https://technologify.net/posts/security/remote-credential-guard/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Remote Credential Guard","name":"Remote Credential Guard","description":"Remote Credential Guard","keywords":["Remote Credential Guard","Kerberos"],"articleBody":"Summary Remote Credential Guard (RCG) protects admin credentials by ensuring they are not passed over the network to a target device. RCG is particularly useful for administrators who need to remotely access and manage servers and other critical systems. By ensuring that credentials are not exposed during these remote sessions, it significantly reduces the risk of credential theft and lateral movement in the network.\nDetails Clients with RCG enabled do not send primary credentials to the target machine. This mitigates the risk of stolen credentials if the target is compromised.\nIn RCG, the client LSA acts as a reverse proxy for ticket requests from the target. Hence, the target never needs to store primary credentials.\nRCG will not allow NTLM fallback.\nThe flow goes something like this (very simplified):\nApp on target (server) needs a ticket so it asks LSA. LSA opens a channel back to the client LSA. Target LSA asks client LSA to ask for a ticket. Client LSA forwards ticket to Target LSA. Limitations Native RDP client only uses logged in user credentials. Devolutions Remote Desktop Manager can use saved credentials. While TGT is encrypted, service tickets are not. If an RDP sesion is initiated to a compromised target or an attacker comrpomises the target while an admin is logged in, the attacker could use the open channel to create sessions on the user’s behalf. “Windows Defender Remote Credential Guard can be used only when connecting to a device that is joined to a Windows Server Active Directory domain, including AD domain-joined servers that run as Azure virtual machines (VMs). Windows Defender Remote Credential Guard cannot be used when connecting to remote devices joined to Azure Active Directory.” “Windows Defender Remote Credential Guard does not support compound authentication. For example, if you’re trying to access a file server from a remote host that requires a device claim, access will be denied.” “Remote Desktop Credential Guard only works with the RDP protocol.” Implementation Requirements Client must:\nrun Windows 10 or Server 2016+ use Kerberos authentication to connect to the target. Server must:\nrun Windows 10 or Server 2016+ Allow Restricted Admin connections Allow Remote Desktop Connections for the user. Allow delegation of non-exportable credentials. (using derivative credentials on a device other than the one it was produced on) Instructions Client\nEnsure the client uses RCG when initating an RDP session: via GPO: From the Group Policy Management Console, go to Computer Configuration -\u003e Administrative Templates -\u003e System -\u003e Credentials Delegation. Set policy to one of the following depending on requirements: Restricted Admin mode or RCG: Choose Restrict Credential Delegation Only RCG: Choose Require Remote Credential Guard Only Restricted Admin mode: Choose Require Restricted Admin with a parameter mstsc.exe /remoteGuard Target Server\nSet the following reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /d 0 /t REG_DWORD Links Windows Defender Remote Credential Guard - Microsoft Docs How Authentication Works when you use Remote Desktop - Steve Syfus “No more Pass-the-Hash” – Exploring the limitations of Remote Credential Guard - Cyber Ark) Implement RCG LAB - Github Microsoft ","wordCount":"505","inLanguage":"en","image":"https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2022-03-19T00:27:04+11:00","dateModified":"2022-03-19T00:27:04+11:00","author":{"@type":"Person","name":"JD"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://technologify.net/posts/security/remote-credential-guard/"},"publisher":{"@type":"Organization","name":"Jdsec","logo":{"@type":"ImageObject","url":"https://technologify.net/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://technologify.net/ accesskey=h title="Home (Alt + H)"><img src=https://technologify.net/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://technologify.net/categories/ title=categories><span>categories</span></a></li><li><a href=https://technologify.net/tags/ title=tags><span>tags</span></a></li><li><a href=https://technologify.net/archives/ title=archives><span>archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://technologify.net/>Home</a>&nbsp;»&nbsp;<a href=https://technologify.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Remote Credential Guard</h1><div class=post-description>Remote Credential Guard</div><div class=post-meta><span title='2022-03-19 00:27:04 +1100 +1100'>19 March, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;505 words&nbsp;·&nbsp;JD</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#summary aria-label=Summary>Summary</a></li><li><a href=#details aria-label=Details>Details</a></li><li><a href=#limitations aria-label=Limitations>Limitations</a></li><li><a href=#implementation aria-label=Implementation>Implementation</a><ul><li><a href=#requirements aria-label=Requirements>Requirements</a></li><li><a href=#instructions aria-label=Instructions>Instructions</a></li></ul></li><li><a href=#links aria-label=Links>Links</a></li></ul></div></details></div><div class=post-content><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>Remote Credential Guard (RCG) protects admin credentials by ensuring they are not passed over the network to a target device. RCG is particularly useful for administrators who need to remotely access and manage servers and other critical systems. By ensuring that credentials are not exposed during these remote sessions, it significantly reduces the risk of credential theft and lateral movement in the network.</p><h2 id=details>Details<a hidden class=anchor aria-hidden=true href=#details>#</a></h2><p>Clients with RCG enabled do not send primary credentials to the target machine. This mitigates the risk of stolen credentials if the target is compromised.</p><p>In RCG, the client LSA acts as a reverse proxy for ticket requests from the target. Hence, the target never needs to store primary credentials.</p><p>RCG will not allow NTLM fallback.</p><p>The flow goes something like this (very simplified):</p><ol><li>App on target (server) needs a ticket so it asks LSA.</li><li>LSA opens a channel back to the client LSA.</li><li>Target LSA asks client LSA to ask for a ticket.</li><li>Client LSA forwards ticket to Target LSA.</li></ol><h2 id=limitations>Limitations<a hidden class=anchor aria-hidden=true href=#limitations>#</a></h2><ul><li>Native RDP client only uses logged in user credentials. Devolutions Remote Desktop Manager can use saved credentials.</li><li>While TGT is encrypted, service tickets are not. If an RDP sesion is initiated to a compromised target or an attacker comrpomises the target while an admin is logged in, the attacker could use the open channel to create sessions on the user&rsquo;s behalf.</li><li>&ldquo;Windows Defender Remote Credential Guard can be used only when connecting to a device that is joined to a Windows Server Active Directory domain, including AD domain-joined servers that run as Azure virtual machines (VMs). Windows Defender Remote Credential Guard cannot be used when connecting to remote devices joined to Azure Active Directory.&rdquo;</li><li>&ldquo;Windows Defender Remote Credential Guard does not support compound authentication. For example, if you’re trying to access a file server from a remote host that requires a device claim, access will be denied.&rdquo;</li><li>&ldquo;Remote Desktop Credential Guard only works with the RDP protocol.&rdquo;</li></ul><h2 id=implementation>Implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h2><h3 id=requirements>Requirements<a hidden class=anchor aria-hidden=true href=#requirements>#</a></h3><p>Client must:</p><ul><li>run Windows 10 or Server 2016+</li><li>use Kerberos authentication to connect to the target.</li></ul><p>Server must:</p><ul><li>run Windows 10 or Server 2016+</li><li>Allow Restricted Admin connections</li><li>Allow Remote Desktop Connections for the user.</li><li>Allow delegation of non-exportable credentials. (using derivative credentials on a device other than the one it was produced on)</li></ul><h3 id=instructions>Instructions<a hidden class=anchor aria-hidden=true href=#instructions>#</a></h3><p>Client</p><ul><li>Ensure the client uses RCG when initating an RDP session:<ul><li>via GPO:<ul><li>From the Group Policy Management Console, go to Computer Configuration -> Administrative Templates -> System -> Credentials Delegation.</li><li>Set policy to one of the following depending on requirements:<ul><li>Restricted Admin mode or RCG: Choose <code>Restrict Credential Delegation</code></li><li>Only RCG: Choose <code>Require Remote Credential Guard</code></li><li>Only Restricted Admin mode: Choose <code>Require Restricted Admin</code></li></ul></li></ul></li><li>with a parameter<ul><li><code>mstsc.exe /remoteGuard</code></li></ul></li></ul></li></ul><p>Target Server</p><ul><li>Set the following <code>reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /d 0 /t REG_DWORD</code></li></ul><h2 id=links>Links<a hidden class=anchor aria-hidden=true href=#links>#</a></h2><ul><li><a href=https://docs.microsoft.com/en-us/windows/security/identity-protection/remote-credential-guard>Windows Defender Remote Credential Guard - Microsoft Docs</a></li><li><a href=https://syfuhs.net/how-authentication-works-when-you-use-remote-desktop>How Authentication Works when you use Remote Desktop - Steve Syfus</a></li><li><a href=https://www.cyberark.com/resources/blog/no-more-pass-the-hash-exploring-the-limitations-of-remote-credential-guard>“No more Pass-the-Hash” – Exploring the limitations of Remote Credential Guard - Cyber Ark)</a></li><li><a href=https://github.com/MicrosoftLearning/40554A-Microsoft-Security-Workshop-Implementing-Windows-10-Security-Features/blob/master/Instructions/40554A_LAB_05.md>Implement RCG LAB - Github Microsoft</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://technologify.net/tags/remote-credential-guard/>Remote Credential Guard</a></li><li><a href=https://technologify.net/tags/kerberos/>Kerberos</a></li></ul><nav class=paginav><a class=prev href=https://technologify.net/posts/security/wpad-security/><span class=title>« Prev</span><br><span>WPAD Security Considerations</span>
</a><a class=next href=https://technologify.net/posts/security/sentinelquerieskql/><span class=title>Next »</span><br><span>SentinelQueriesKQL</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://technologify.net/>Jdsec</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>