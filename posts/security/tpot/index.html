<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Creating a Honeypot with T-Pot | Jdsec</title>
<meta name=keywords content="Honeypot"><meta name=description content="Tpot"><meta name=author content="JD"><link rel=canonical href=https://technologify.net/posts/security/tpot/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://technologify.net/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://technologify.net/posts/security/tpot/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://technologify.net/posts/security/tpot/"><meta property="og:site_name" content="Jdsec"><meta property="og:title" content="Creating a Honeypot with T-Pot"><meta property="og:description" content="Tpot"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-16T13:56:28+11:00"><meta property="article:modified_time" content="2022-01-16T13:56:28+11:00"><meta property="article:tag" content="Honeypot"><meta property="og:image" content="https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Creating a Honeypot with T-Pot"><meta name=twitter:description content="Tpot"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://technologify.net/posts/"},{"@type":"ListItem","position":2,"name":"Creating a Honeypot with T-Pot","item":"https://technologify.net/posts/security/tpot/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Creating a Honeypot with T-Pot","name":"Creating a Honeypot with T-Pot","description":"Tpot","keywords":["Honeypot"],"articleBody":"Summary Tpotce is an all-in-one honeypot platform with a collection of honeypots and tools for monitoring them.\nRequirements 8GB RAM 128GB Disk Space Unfiltered Internet Access Isolated Subnet Promiscious Mode Enabled for fatt, suricata and p0f to work properly Port forward or NAT to the honeypot Installation Set up is simple as the ISO is prebuilt.\nDownload the latest ISO from Tpotce releases Mount the ISO to a VM and run through the installer. Select “Standard” as an install option. The install should take around 30 minutes. Network Configuration Isolated Subnet To prevent attackers from accessing your internal network via the honeypot, you need to create an isolated subnet.\nIn Unifi-land you can create an isolated subnet by: a) setting a different VLAN ID for your isolated network. (Layer 2) b) Enabling Device Isolation which effectively marks the network as a Guest Network and applies Guest Rules. (Layer 3/4)\nBased on my testing, built-in Guest Rules perform the following:\nLAN to Guest Allowed Guest to LAN not Allowed Stateful traffic not Allowed DNS requests to anywhere Allowed Unifi Firewalls have 3 types of networks (Internet,LAN,Guest) with 3 types of rules (In, Out, Local).\nTypes of Networks Internet is simple enough. Anything not RFC1918 is considered an Internet network.\nLAN is any network without Device Isolation enabled.\nGuest is any network with Device Isolation enabled.\nTypes of Rules This part is a bit tricky as you need to think from the firewall’s perspective.\nLet’s consider Guest IN rules. These match traffic from the Guest Network IN to the firewall, then to the LAN.\nGuest OUT is the opposite, any traffic from the firewall OUT to the Guest Network. So LAN to Guest traffic would match Guest OUT rules.\nGuest LOCAL is more simple. It’s the router interface, i.e. the default gateway. Here instead of allowing default rules which include DNS, ICMP, and RADIUS, I only allow DHCP.\nPort Forwarding Ports 1-64000 should be forwarded to tpot.\nIf you need to access the Web UI externally, you can forward ports 64297 and 64294.\nPort Mirroring (optional) I use vSphere 6.7U3 with a VDS and use Security Onion 2.3. To mirror traffic to a monitoring interface:\nRight click the VDS \u003e Configure \u003e Port Mirroring New \u003e Distributed Port Mirroring \u003e Next \u003e Status = Enabled \u003e Set Sampling rate if required \u003e Next. Select the Source Interface \u003e Next Select the Destination Interface \u003e Next Finish Post-Installation Visit the T-Pot WebUI at https://:64294 and enjoy.\nTroubleshooting I had some routing issues from the TPOT host to my LAN as my internal network uses 192.168.0.0/16 IP range. The route for 192.168.0.0/20 created by TPOT prevented traffic from returning to my LAN so I created another /32 static route for my computer.\nI think it would be good if TPOT excludes the 192.168.1.0/24 subnet.\n","wordCount":"470","inLanguage":"en","image":"https://technologify.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2022-01-16T13:56:28+11:00","dateModified":"2022-01-16T13:56:28+11:00","author":{"@type":"Person","name":"JD"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://technologify.net/posts/security/tpot/"},"publisher":{"@type":"Organization","name":"Jdsec","logo":{"@type":"ImageObject","url":"https://technologify.net/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://technologify.net/ accesskey=h title="Home (Alt + H)"><img src=https://technologify.net/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://technologify.net/categories/ title=categories><span>categories</span></a></li><li><a href=https://technologify.net/tags/ title=tags><span>tags</span></a></li><li><a href=https://technologify.net/archives/ title=archives><span>archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://technologify.net/>Home</a>&nbsp;»&nbsp;<a href=https://technologify.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Creating a Honeypot with T-Pot</h1><div class=post-description>Tpot</div><div class=post-meta><span title='2022-01-16 13:56:28 +1100 +1100'>16 January, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;470 words&nbsp;·&nbsp;JD</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#summary aria-label=Summary>Summary</a></li><li><a href=#requirements aria-label=Requirements>Requirements</a></li><li><a href=#installation aria-label=Installation>Installation</a></li><li><a href=#network-configuration aria-label="Network Configuration">Network Configuration</a><ul><li><a href=#isolated-subnet aria-label="Isolated Subnet">Isolated Subnet</a><ul><li><a href=#types-of-networks aria-label="Types of Networks">Types of Networks</a></li><li><a href=#types-of-rules aria-label="Types of Rules">Types of Rules</a></li></ul></li><li><a href=#port-forwarding aria-label="Port Forwarding">Port Forwarding</a></li><li><a href=#port-mirroring-optional aria-label="Port Mirroring (optional)">Port Mirroring (optional)</a></li></ul></li><li><a href=#post-installation aria-label=Post-Installation>Post-Installation</a></li><li><a href=#troubleshooting aria-label=Troubleshooting>Troubleshooting</a></li></ul></div></details></div><div class=post-content><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p><a href=https://github.com/telekom-security/tpotce>Tpotce</a> is an all-in-one honeypot platform with a collection of honeypots and tools for monitoring them.</p><p><img loading=lazy src=/images/2023-11-11-19-16-46.png></p><h2 id=requirements>Requirements<a hidden class=anchor aria-hidden=true href=#requirements>#</a></h2><ul><li>8GB RAM</li><li>128GB Disk Space</li><li>Unfiltered Internet Access</li><li>Isolated Subnet</li><li>Promiscious Mode Enabled for fatt, suricata and p0f to work properly</li><li>Port forward or NAT to the honeypot</li></ul><h2 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h2><p>Set up is simple as the ISO is prebuilt.</p><ol><li>Download the latest ISO from <a href=https://github.com/telekom-security/tpotce/releases>Tpotce releases</a></li><li>Mount the ISO to a VM and run through the installer.</li><li>Select &ldquo;Standard&rdquo; as an install option.</li><li>The install should take around 30 minutes.</li></ol><h2 id=network-configuration>Network Configuration<a hidden class=anchor aria-hidden=true href=#network-configuration>#</a></h2><h3 id=isolated-subnet>Isolated Subnet<a hidden class=anchor aria-hidden=true href=#isolated-subnet>#</a></h3><p>To prevent attackers from accessing your internal network via the honeypot, you need to create an isolated subnet.</p><p>In Unifi-land you can create an isolated subnet by:
a) setting a different VLAN ID for your isolated network. (Layer 2)
b) Enabling <strong>Device Isolation</strong> which effectively marks the network as a Guest Network and applies <strong>Guest Rules</strong>. (Layer 3/4)</p><p>Based on my testing, built-in Guest Rules perform the following:</p><ul><li>LAN to Guest Allowed</li><li>Guest to LAN not Allowed</li><li>Stateful traffic not Allowed</li><li>DNS requests to anywhere Allowed</li></ul><p><img alt="Unifi Network Settings" loading=lazy src=/tpot-network-settings.png></p><p>Unifi Firewalls have 3 types of networks (Internet,LAN,Guest) with 3 types of rules (In, Out, Local).</p><h4 id=types-of-networks>Types of Networks<a hidden class=anchor aria-hidden=true href=#types-of-networks>#</a></h4><p>Internet is simple enough. Anything not RFC1918 is considered an Internet network.</p><p>LAN is any network without Device Isolation enabled.</p><p>Guest is any network with Device Isolation enabled.</p><h4 id=types-of-rules>Types of Rules<a hidden class=anchor aria-hidden=true href=#types-of-rules>#</a></h4><p>This part is a bit tricky as you need to think from the firewall&rsquo;s perspective.</p><p>Let&rsquo;s consider Guest IN rules. These match traffic from the Guest Network <strong>IN to</strong> the firewall, then to the LAN.</p><p>Guest OUT is the opposite, any traffic from the firewall <strong>OUT to</strong> the Guest Network. So LAN to Guest traffic would match Guest OUT rules.</p><p>Guest LOCAL is more simple. It&rsquo;s the router interface, i.e. the default gateway. Here instead of allowing default rules which include DNS, ICMP, and RADIUS, I only allow DHCP.</p><h3 id=port-forwarding>Port Forwarding<a hidden class=anchor aria-hidden=true href=#port-forwarding>#</a></h3><p>Ports 1-64000 should be forwarded to tpot.</p><p>If you need to access the Web UI externally, you can forward ports 64297 and 64294.</p><h3 id=port-mirroring-optional>Port Mirroring (optional)<a hidden class=anchor aria-hidden=true href=#port-mirroring-optional>#</a></h3><p>I use vSphere 6.7U3 with a VDS and use <a href=https://securityonionsolutions.com/>Security Onion 2.3</a>. To mirror traffic to a monitoring interface:</p><ol><li>Right click the VDS > Configure > Port Mirroring</li><li>New > Distributed Port Mirroring > Next > Status = Enabled > Set Sampling rate if required > Next.</li><li>Select the Source Interface > Next</li><li>Select the Destination Interface > Next</li><li>Finish</li></ol><h2 id=post-installation>Post-Installation<a hidden class=anchor aria-hidden=true href=#post-installation>#</a></h2><p>Visit the T-Pot WebUI at <em>https://&lt;IP/FQDN>:64294</em> and enjoy.</p><h2 id=troubleshooting>Troubleshooting<a hidden class=anchor aria-hidden=true href=#troubleshooting>#</a></h2><p>I had some routing issues from the TPOT host to my LAN as my internal network uses 192.168.0.0/16 IP range. The route for 192.168.0.0/20 created by TPOT prevented traffic from returning to my LAN so I created another /32 static route for my computer.</p><p>I think it would be good if TPOT excludes the 192.168.1.0/24 subnet.</p><p><img alt="Routing Issue" loading=lazy src=/tpot-route.png></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://technologify.net/tags/honeypot/>Honeypot</a></li></ul><nav class=paginav><a class=prev href=https://technologify.net/posts/draft/ad-password-audit/><span class=title>« Prev</span><br><span>AD Password Audit</span>
</a><a class=next href=https://technologify.net/posts/security/hugo/><span class=title>Next »</span><br><span>Hugo</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://technologify.net/>Jdsec</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>